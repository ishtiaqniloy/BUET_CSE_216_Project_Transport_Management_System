CREATE TYPE PENALTY_INFO_OBJECT AS OBJECT(
				OBJECT_LICENSE_NO NUMBER,
				OBJECT_PENALTY_NO NUMBER
				
);
/ 
CREATE TYPE PENALTY_INFO_TABLE IS TABLE OF PENALTY_INFO_OBJECT;
/
CREATE OR REPLACE 
	FUNCTION GENERATE_PENALTY_INFO
	RETURN PENALTY_INFO_TABLE PIPELINED IS
	PENALTY_INFO_ROW PENALTY_INFO_OBJECT;
	PENALTY_NUMBERS NUMBER;
BEGIN
	FOR R IN (SELECT LICENSE_NO FROM LICENSE)
	LOOP
		SELECT COUNT(*) INTO PENALTY_NUMBERS FROM PENALTYHISTORY WHERE LICENSE_NO = R.LICENSE_NO;
		PIPE ROW(PENALTY_INFO_OBJECT(R.LICENSE_NO,PENALTY_NUMBERS));
	END LOOP;
	
END;
/

SELECT * from TABLE (GENERATE_PENALTY_INFO);