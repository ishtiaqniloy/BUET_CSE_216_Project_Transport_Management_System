CREATE OR REPLACE 
PROCEDURE LICENSE_STATUS_CHANGE
IS
PENALTY_NO NUMBER;
BEGIN
	FOR R IN (SELECT * FROM TABLE(GENERATE_PENALTY_INFO))
	LOOP
		IF(R.OBJECT_PENALTY_NO > 2) THEN
			DBMS_OUTPUT.PUT_LINE('CHANGING THE STATUS OF A LICENSE '||R.OBJECT_LICENSE_NO);
			UPDATE LICENSE SET STATUS = 'SUSPENDED' WHERE LICENSE_NO = R.OBJECT_LICENSE_NO;
		END IF;
	END LOOP;
END;
/

CREATE OR REPLACE TRIGGER FAIL_ACTION
AFTER UPDATE OF RESULT
ON APPLICATION
FOR EACH ROW
DECLARE 
	RSLT VARCHAR2(100);
BEGIN
	IF(:NEW.RESULT = 'FAILED') THEN
		DELETE FROM DRIVER D WHERE D.DRIVER_NID = :NEW.DRIVER_NID;
	END IF;
END;
/